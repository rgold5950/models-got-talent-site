<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Models Got Talent - Experiment Results</title>

    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">

    <!-- Custom styles -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 5px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #3498db;
        }

        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        .model-link {
            color: #3498db;
            text-decoration: none;
        }

        .model-link:hover {
            text-decoration: underline;
        }

        .dataTables_wrapper {
            margin-top: 20px;
        }

        .dataTables_filter {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Models Got Talent</h1>

        <div class="stats">
            <div class="stat">
                <div class="stat-number">10</div>
                <div class="stat-label">Total Models</div>
            </div>
            <div class="stat">
                <div class="stat-number">9</div>
                <div class="stat-label">Datasets</div>
            </div>
            <div class="stat">
                <div class="stat-number">4</div>
                <div class="stat-label">Model Families</div>
            </div>
            <div class="stat">
                <div class="stat-number">355.0M</div>
                <div class="stat-label">Max Parameters</div>
            </div>
        </div>

        <table id="models-table" class="display">
            <thead>
                <tr>
                    <th>Model Id</th><th>Dataset</th><th>Model Family</th><th>Model Type</th><th>Best Val Accuracy</th><th>Best Test Accuracy</th><th>Val Loss</th><th>Test Loss</th><th>Parameter Count</th><th>Training Time Hours</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data will be loaded via JavaScript -->
            </tbody>
        </table>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

    <!-- DataTables JS -->
    <script type="text/javascript" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>

    <!-- PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

    <script>
        $(document).ready(function() {
            // Load CSV data
            Papa.parse('data/models.csv', {
                download: true,
                header: true,
                complete: function(results) {
                    if (results.errors.length > 0) {
                        console.error('CSV parsing errors:', results.errors);
                        return;
                    }

                    // Process the data
                    var processedData = results.data.map(function(row) {
                        var processedRow = [];

                        // Process each column
                        ["model_id", "dataset", "model_family", "model_type", "best_val_accuracy", "best_test_accuracy", "val_loss", "test_loss", "parameter_count", "training_time_hours"].forEach(function(col) {
                            var value = row[col];

                            // Special handling for model_id - make it a link
                            if (col === 'model_id' && value) {
                                processedRow.push('<a href="#" class="model-link" onclick="showModelDetails('' + value + '')">' + value + '</a>');
                            }
                            // Format numeric values
                            else if (['best_val_accuracy', 'best_test_accuracy'].includes(col) && !isNaN(value)) {
                                processedRow.push((parseFloat(value) * 100).toFixed(2) + '%');
                            }
                            else if (['val_loss', 'test_loss'].includes(col) && !isNaN(value)) {
                                processedRow.push(parseFloat(value).toFixed(4));
                            }
                            else if (col === 'parameter_count' && !isNaN(value)) {
                                var count = parseInt(value);
                                if (count >= 1000000) {
                                    processedRow.push((count / 1000000).toFixed(1) + 'M');
                                } else if (count >= 1000) {
                                    processedRow.push((count / 1000).toFixed(1) + 'K');
                                } else {
                                    processedRow.push(count.toString());
                                }
                            }
                            else if (col === 'training_time_hours' && !isNaN(value)) {
                                processedRow.push(parseFloat(value).toFixed(1) + 'h');
                            }
                            else {
                                processedRow.push(value || '');
                            }
                        });

                        return processedRow;
                    });

                    // Initialize DataTable
                    $('#models-table').DataTable({
                        data: processedData,
                        columns: [
                            { title: "Model Id" },{ title: "Dataset" },{ title: "Model Family" },{ title: "Model Type" },{ title: "Best Val Accuracy" },{ title: "Best Test Accuracy" },{ title: "Val Loss" },{ title: "Test Loss" },{ title: "Parameter Count" },{ title: "Training Time Hours" }
                        ],
                        pageLength: 25,
                        order: [[4, 'desc']], // Sort by test accuracy by default
                        responsive: true,
                        dom: '<"top"f>rt<"bottom"lp><"clear">',
                        language: {
                            search: "Search models:",
                            lengthMenu: "Show _MENU_ models per page",
                            info: "Showing _START_ to _END_ of _TOTAL_ models",
                            infoEmpty: "No models found",
                            infoFiltered: "(filtered from _MAX_ total models)"
                        }
                    });
                },
                error: function(error) {
                    console.error('Error loading CSV:', error);
                    $('#models-table').html('<tr><td colspan="10">Error loading data. Please check the console for details.</td></tr>');
                }
            });
        });

        function showModelDetails(modelId) {
            // Placeholder for model detail functionality
            alert('Model details for: ' + modelId + '\n\n(This will be implemented to show detailed model information)');
        }
    </script>
</body>
</html>